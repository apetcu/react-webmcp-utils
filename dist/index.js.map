{"version":3,"sources":["../src/useWebMCP.ts","../src/types.ts","../src/useModelContext.ts","../src/useRegisterTool.ts","../src/useToolCallback.ts"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\nimport { initPolyfill } from \"@adipetcu/webmcp-polyfill\";\nimport type { ModelContext, ModelContextOptions } from \"@adipetcu/webmcp-polyfill\";\nimport { getModelContext } from \"./types\";\n\nexport interface UseWebMCPOptions extends ModelContextOptions {}\n\nexport interface UseWebMCPResult {\n  modelContext: ModelContext | null;\n  isReady: boolean;\n}\n\nexport function useWebMCP(options?: UseWebMCPOptions): UseWebMCPResult {\n  const [isReady, setIsReady] = useState(false);\n  const optionsRef = useRef(options);\n  optionsRef.current = options;\n\n  useEffect(() => {\n    initPolyfill();\n\n    const ctx = getModelContext();\n    if (ctx && optionsRef.current) {\n      ctx.provideContext(optionsRef.current);\n    }\n\n    setIsReady(true);\n\n    return () => {\n      if (ctx && optionsRef.current) {\n        ctx.clearContext();\n      }\n    };\n  }, []);\n\n  return {\n    modelContext: isReady ? getModelContext() : null,\n    isReady,\n  };\n}\n","import type { ModelContext } from \"@adipetcu/webmcp-polyfill\";\n\ndeclare global {\n  interface Navigator {\n    modelContext?: ModelContext;\n  }\n}\n\nexport function getModelContext(): ModelContext | null {\n  if (typeof navigator === \"undefined\") return null;\n  return navigator.modelContext ?? null;\n}\n","import { useSyncExternalStore } from \"react\";\nimport type { ModelContext } from \"@adipetcu/webmcp-polyfill\";\nimport { getModelContext } from \"./types\";\n\nconst noop = () => () => {};\nconst getServerSnapshot = (): ModelContext | null => null;\n\nexport function useModelContext(): ModelContext | null {\n  return useSyncExternalStore(noop, getModelContext, getServerSnapshot);\n}\n","import { useEffect } from \"react\";\nimport type { ToolAnnotations, ToolExecuteCallback } from \"@adipetcu/webmcp-polyfill\";\nimport { getModelContext } from \"./types\";\nimport { useToolCallback } from \"./useToolCallback\";\n\nexport interface UseRegisterToolOptions {\n  name: string;\n  description: string;\n  inputSchema?: Record<string, unknown>;\n  execute: ToolExecuteCallback;\n  annotations?: ToolAnnotations;\n  enabled?: boolean;\n}\n\nexport function useRegisterTool(options: UseRegisterToolOptions): void {\n  const { name, description, inputSchema, annotations, enabled = true } = options;\n  const stableExecute = useToolCallback(options.execute);\n\n  useEffect(() => {\n    if (!enabled) return;\n\n    const ctx = getModelContext();\n    if (!ctx) return;\n\n    try {\n      ctx.registerTool({\n        name,\n        description,\n        inputSchema,\n        execute: stableExecute,\n        annotations,\n      });\n    } catch {\n      // Ignore duplicate registration errors (React Strict Mode)\n    }\n\n    return () => {\n      try {\n        ctx.unregisterTool(name);\n      } catch {\n        // Ignore if already unregistered (React Strict Mode)\n      }\n    };\n  }, [name, description, inputSchema, stableExecute, annotations, enabled]);\n}\n","import { useCallback, useRef } from \"react\";\nimport type { ToolExecuteCallback } from \"@adipetcu/webmcp-polyfill\";\n\nexport function useToolCallback(callback: ToolExecuteCallback): ToolExecuteCallback {\n  const ref = useRef(callback);\n  ref.current = callback;\n\n  return useCallback<ToolExecuteCallback>(\n    (input, client) => ref.current(input, client),\n    [],\n  );\n}\n"],"mappings":";AAAA,SAAS,WAAW,QAAQ,gBAAgB;AAC5C,SAAS,oBAAoB;;;ACOtB,SAAS,kBAAuC;AACrD,MAAI,OAAO,cAAc,YAAa,QAAO;AAC7C,SAAO,UAAU,gBAAgB;AACnC;;;ADCO,SAAS,UAAU,SAA6C;AACrE,QAAM,CAAC,SAAS,UAAU,IAAI,SAAS,KAAK;AAC5C,QAAM,aAAa,OAAO,OAAO;AACjC,aAAW,UAAU;AAErB,YAAU,MAAM;AACd,iBAAa;AAEb,UAAM,MAAM,gBAAgB;AAC5B,QAAI,OAAO,WAAW,SAAS;AAC7B,UAAI,eAAe,WAAW,OAAO;AAAA,IACvC;AAEA,eAAW,IAAI;AAEf,WAAO,MAAM;AACX,UAAI,OAAO,WAAW,SAAS;AAC7B,YAAI,aAAa;AAAA,MACnB;AAAA,IACF;AAAA,EACF,GAAG,CAAC,CAAC;AAEL,SAAO;AAAA,IACL,cAAc,UAAU,gBAAgB,IAAI;AAAA,IAC5C;AAAA,EACF;AACF;;;AEtCA,SAAS,4BAA4B;AAIrC,IAAM,OAAO,MAAM,MAAM;AAAC;AAC1B,IAAM,oBAAoB,MAA2B;AAE9C,SAAS,kBAAuC;AACrD,SAAO,qBAAqB,MAAM,iBAAiB,iBAAiB;AACtE;;;ACTA,SAAS,aAAAA,kBAAiB;;;ACA1B,SAAS,aAAa,UAAAC,eAAc;AAG7B,SAAS,gBAAgB,UAAoD;AAClF,QAAM,MAAMA,QAAO,QAAQ;AAC3B,MAAI,UAAU;AAEd,SAAO;AAAA,IACL,CAAC,OAAO,WAAW,IAAI,QAAQ,OAAO,MAAM;AAAA,IAC5C,CAAC;AAAA,EACH;AACF;;;ADGO,SAAS,gBAAgB,SAAuC;AACrE,QAAM,EAAE,MAAM,aAAa,aAAa,aAAa,UAAU,KAAK,IAAI;AACxE,QAAM,gBAAgB,gBAAgB,QAAQ,OAAO;AAErD,EAAAC,WAAU,MAAM;AACd,QAAI,CAAC,QAAS;AAEd,UAAM,MAAM,gBAAgB;AAC5B,QAAI,CAAC,IAAK;AAEV,QAAI;AACF,UAAI,aAAa;AAAA,QACf;AAAA,QACA;AAAA,QACA;AAAA,QACA,SAAS;AAAA,QACT;AAAA,MACF,CAAC;AAAA,IACH,QAAQ;AAAA,IAER;AAEA,WAAO,MAAM;AACX,UAAI;AACF,YAAI,eAAe,IAAI;AAAA,MACzB,QAAQ;AAAA,MAER;AAAA,IACF;AAAA,EACF,GAAG,CAAC,MAAM,aAAa,aAAa,eAAe,aAAa,OAAO,CAAC;AAC1E;","names":["useEffect","useRef","useEffect"]}